@using Business_Model.Helper;
@model  IEnumerable<Business_Model.Model._Marketing>


@section PageStyle
{
    <title>Build My Unicorn - Marketing Plan</title>
    <link href="~/assets/node_modules/wizard/steps.css" rel="stylesheet">
    <link href="~/assets/node_modules/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet">
    <link href="~/Simple-Plain-Bar-Chart-Plugin-With-jQuery-barCharts/jquery.barCharts.css" rel="stylesheet" />
    <link href="~/assets/node_modules/Magnific-Popup-master/dist/magnific-popup.css" rel="stylesheet">
    <link href="~/assetsss/css/style.css" rel="stylesheet" />
    <link href="~/assets/node_modules/draggable-resizable-modal/css/modalbox.css" rel="stylesheet" />
    <link href="~/assets/node_modules/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/node_modules/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
    <link href="~/assets/node_modules/select2/dist/css/select2.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/node_modules/image-picker/image-picker.css" rel="stylesheet" />
    <script src="~/assets/node_modules/jquery-confirm/jquery-confirm.js"></script>
    <link href="~/assets/node_modules/jquery-confirm/jquery-confirm.css" rel="stylesheet" />
    <style>
        .progress {
            // display: flex;
            // height: auto !important;
            width: 100%;
            // font-size: .65625rem;
            background-color: #303641;
            border-radius: .25rem;
            background: red;
            z-index: 0;
            //width: 500px;
            // height: 10px !important;
        }

        div.progress {
            height: 10px;
        }

        div.steps li a {
            // color: #fff !important;
        }


        .modal-dialog {
            position: relative;
            display: table;
            overflow: auto;
            width: auto;
            min-width: 300px;
        }

        .modal-body { /* Restrict Modal width to 90% */
            overflow-x: auto !important;
            max-width: 90vw !important;
        }

        .youtube-icon {
            position: absolute;
            top: 40%;
            left: 45%;
            font-size: 30px;
        }

        .youtube-icon {
            position: absolute;
            top: 40%;
            left: 45%;
            font-size: 30px;
        }

            .youtube-icon:hover {
                font-size: 40px;
                color: red;
            }

        .titlebar_title {
            color: #333;
        }

        .table td, .table th {
            padding: 0.5rem !important;
        }

        th {
            font-size: 13px;
        }

        .titlebar_title {
            color: #333;
        }

        .bootstrap-tagsinput {
            line-height: 62px;
            width: 100%;
        }

        .image_picker_image {
            width: 120px;
            height: 120px;
        }

        ul.thumbnails.image_picker_selector {
            max-height: 300px;
            overflow-y: auto;
        }

        .modal {
            overflow: auto !important;
        }

        .row {
            overflow: hidden;
        }

        [class*="col-"] {
            margin-bottom: -99999px;
            padding-bottom: 99999px;
        }
    </style>

}


<div class="row page-titles">
    <div class="col-md-5 align-self-center">
        <h4 class="text-themecolor">Plan</h4>
    </div>
    <div class="col-md-7 align-self-center text-right">
        <div class="d-flex justify-content-end align-items-center">
            <ol class="breadcrumb">


                <li class="breadcrumb-item"><a href="javascript:void(0)"> Home</a></li>
                <li class="breadcrumb-item">Marketing </li>
                <li class="breadcrumb-item active"> Plan &nbsp;&nbsp; </li>
                @if (Model.Count() > 0)
                {
                    <li style="margin:0px;padding:0px"><a href="~/Marketing/Create" class="btn btn-info">Add  New</a></li>
                }
            </ol>
        </div>
    </div>
</div>

<div class="row " style="margin: 0 0px 2px;">
    <div class="col-md-5 align-self-center">
        <h4 class="card-title" id="1"></h4>
    </div>
    <div class="col-md-7 align-self-center text-right">
        <div class="d-flex justify-content-end align-items-center">
            <i class="mdi mdi-arrow-left"></i>  @Html.ActionLink("Back to Overview", "Index", "ModuleCourse", new { ControllerName = "Marketing", ActionName = "Plan", ModuleID = (int)Business_Model.Model.Module.Marketing, SectionID = (int)Business_Model.Model.ModuleSection.Marketing_MarketingPlan }, new { @class = "" })
        </div>
    </div>
</div>
<div class="row">
    @if (Model.Count() > 0)
    {
        foreach (var item in Model)
        {

            <div class="col-md-6 col-lg-6 col-xl-4">
                <div class="card card-body">
                    <div class="row align-items-center">

                        <div class="col-md-12 col-lg-12">
                            <h3 class="box-title m-b-0">@item.PlanName </h3>




                            <address>

                                <b>Goal :</b> @item.GoalValue
                                <br>
                                <b>Audience Reach Plan :</b>  @item.AudianceReachValue
                            </address>
                        </div>
                        <div class="col-md-12 text-right" style="font-size:19px">

                            <span style="color:#e83e8c; cursor:pointer" data-id="@item.MarketingPlanID" class="jsDeletePlan"> <i class="fa fa-trash"></i></span>
                            <a href="~/Marketing/Edit/@item.MarketingPlanID" title="Update Marketing Plan"><i class="icons-Pencil"></i></a>
                        </div>
                    </div>
                </div>
            </div>


        }
    }
    else
    {
        <div class="col-md-12">
            <!-- Card -->
            <div class="card text-center">
                <div class="card-header">

                </div>
                <div class="card-body">
                    <h4 class="card-title">No Marketing Plan Found</h4>
                    <p class="card-text">Your Marketing Plan will be added here.</p>

                    <a href="~/Marketing/Create" class="btn btn-info">Add </a>
                </div>
                <div class="card-footer text-muted">

                </div>
            </div>
        </div>

    }
</div>


@*@if (Model == (int)EntityState.Old)
    {
        <button type="button" class="btn btn-info d-none d-lg-block m-l-15 JsDownloadIdea"> <i class="fas fa-file-pdf"></i> Download</button>
        <button type="button" class="btn btn-primary d-none d-lg-block m-l-15 JsUpdate"> Update</button>

    }*@


@*<div id="myDialog3">
        <iframe id="cartoonVideo" width="100%" height="100%" src="@(ViewBag.Video != null ?  ViewBag.Video.VideoUrl : "")" auto frameborder="0" allowfullscreen></iframe>
    </div>*@






@section PageScript
{
    <!-- This Page JS -->
    <script src="~/assets/node_modules/wizard/jquery.steps.min.js"></script>
    <script src="~/assets/node_modules/wizard/jquery.validate.min.js"></script>
    <script src="~/assets/node_modules/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <script src="~/assets/node_modules/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <script src="~/assets/node_modules/sparkline/jquery.sparkline.min.js"></script>
    <script src="~/assets/node_modules/select2/dist/js/select2.full.min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="~/assets/node_modules/Magnific-Popup-master/dist/jquery.magnific-popup.min.js"></script>
    <script src="~/assets/node_modules/Magnific-Popup-master/dist/jquery.magnific-popup-init.js"></script>
    <script src="~/assets/node_modules/draggable-resizable-modal/js/modalbox.js"></script>
    <script src="~/assets/node_modules/switchery/dist/switchery.min.js"></script>
    <script src="~/assets/node_modules/image-picker/image-picker.js"></script>
    <script src="~/assets/node_modules/bootstrap-select/bootstrap-select.min.js" type="text/javascript"></script>
    <script src="~/assetsss/js/jq.progress-bar.js"></script>
    <script src="@Url.ContentVersioned("~/page_script/marketing.js")"></script>

    <script>
        $(function () {
            $('#BuyerPersonaID')
                .select2()
                .on('select2:open', () => {
                    $(".select2-results:not(:has(a))").append('<a href="#" style="padding: 6px;height: 20px;display: inline-table;" Class="jsAddNewPersona"> <i class="fa fa-plus-circle"></i> Add New </a>');
                }).on('select2:close', function () {
                    var el = $(this);
                    if (el.val() === "NEW") {
                        $(this).val("").change();
                        //var newval = prompt("Enter new value: ");
                        //if (newval !== null) {
                        //    el.append('<option>uuu' + newval + '</option>')
                        //        .val(newval);
                        //}
                    }
                });

            $('#GoalID')
                .select2();
            $('#GoalID')
                .select2();
            $('#AudianceReachID')
                .select2();
        });



        $(document).on("click", ".jsAddNewPersona", function () {
            $("#BuyerPersonaID").select2("close");
            $('#BuyerPersonaID').val("0");
            $('#BuyerPersonaID').select2().trigger('change');
            $("#buyerPersonaModal").modal("toggle");
            // $("#select2").val("0").change();
        });


        $(document).on("click", ".jsAddAvtar", function () {


            $("#AvtarID").val($("#JsimagePicker").val());
            var src = "/assets/images/avtar/Avatar Users2_" + $("#AvtarID").val() + ".png?rand=" + Math.random();
            $('#avtarSelected').attr('src', src);
            $('#avtarModal').modal('toggle');

        });

        $("#frmBuyerPersona").submit(function (event) {
            event.preventDefault();
            $.ajax({
                url: GetBaseURL() + "Business/AddBuyerPersona",
                method: "POST",
                data: $('#frmBuyerPersona').serialize(),
                success: function (response) {

                    if (response.Status === "OK") {
                        if (typeof showMessage === 'undefined') {
                            CommonFunctions.SuccessMessage("Success", "Buyer Persona updated successfully");
                        }

                        $("#frmBuyerPersona")[0].reset();
                        $(".jsCustomerID").val(response.CustomerID);
                        GetBuyerPersona();
                    }


                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    $(".erorLabel").removeClass("invisible");
                    $(".errorMessage").text("Status: " + textStatus + "Error: " + errorThrown);
                }
            });
        });

    </script>
    <script>

        jQuery("select.image-picker").imagepicker({
            hide_select: false,
            //show_label: true
        });
        $("#myDialog3").myOwnDialog(
            {
                autoClose: false,
                width: "400",
                pos_y: "50",
                height: "300",
                bg_color: 'white',
                title: '@(ViewBag.Video != null ?  ViewBag.Video.Title : "")',
                body_margin:  '@(ViewBag.Video != null ?  ViewBag.Video.Duration : "")',
                body_overflow_x: "hidden",
                body_overflow_y: "scroll",
                movable: true,
                resizable: true,
                touchOutsideForClose: false
            });

    </script>
    @*@{
            if (Model == (int)EntityState.New)
            {
                <script>setTimeout(function () { $("#myDialog3").myOwnDialog("open"); }, 1000);</script> }
        }*@
    <script>
        // This is for the sticky sidebar
        $(".stickyside").stick_in_parent({
            offset_top: 100
        });

        $('.stickyside a').click(function () {
            $('html, body').animate({
                scrollTop: $($(this).attr('href')).offset().top - 100
            }, 500);
            return false;
        });
        // This is auto select left sidebar
        // Cache selectors
        // Cache selectors
        var lastId,
            topMenu = $(".stickyside"),
            topMenuHeight = topMenu.outerHeight(),
            // All list items
            menuItems = topMenu.find("a"),
            // Anchors corresponding to menu items
            scrollItems = menuItems.map(function () {
                var item = $($(this).attr("href"));
                if (item.length) {
                    return item;
                }
            });

        // Bind click handler to menu items


        // Bind to scroll
        $(window).scroll(function () {
            // Get container scroll position
            var fromTop = $(this).scrollTop() + topMenuHeight - 250;

            // Get id of current scroll item
            var cur = scrollItems.map(function () {
                if ($(this).offset().top < fromTop)
                    return this;
            });

            // Get the id of the current element
            cur = cur[cur.length - 1];
            var id = cur && cur.length ? cur[0].id : "";


            if (lastId !== id) {
                lastId = id;
                // Set/remove active class
                menuItems
                    .removeClass("active")
                    .filter("[href='#" + id + "']").addClass("activee");
            }
        });
    </script>
    <script>
        $(document).ready(function () {
            /* Get iframe src attribute value i.e. YouTube video url
            and store it in a variable */
            var url = $("#cartoonVideo").attr('src');


            /* Assign empty url value to the iframe src attribute when
            modal hide, which stop the video playing */
            $("#myModal").on('hide.bs.modal', function () {
                $("#cartoonVideo").attr('src', '');
            });

            /* Assign the initially stored url back to the iframe src
            attribute when modal is displayed again */
            $("#myModal").on('show.bs.modal', function () {
                $("#cartoonVideo").attr('src', url);
            });


        });

    </script>
    <script>
        $(document).ready(function () {
            $('.selectpicker').selectpicker('refresh');

        });
    </script>
}