@using Business_Model.Helper;
@model Int32

@section PageStyle
{
    <title>Build My Unicorn - Business Operation</title>
    <link href="~/assets/node_modules/wizard/steps.css" rel="stylesheet">
    <link href="~/assets/node_modules/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet">
    <link href="~/assets/node_modules/Magnific-Popup-master/dist/magnific-popup.css" rel="stylesheet">
    @*<link href="~/assetsss/css/style.css" rel="stylesheet" />*@
    <link href="~/assets/node_modules/draggable-resizable-modal/css/modalbox.css" rel="stylesheet" />
    <link href="~/assets/node_modules/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/node_modules/multiselect/css/multi-select.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/node_modules/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
    <link href="~/assets/node_modules/select2/dist/css/select2.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/node_modules/bootstrap-tagsinput/dist/bootstrap-tagsinput.css" rel="stylesheet" />
    <link href="~/assets/node_modules/image-picker/image-picker.css" rel="stylesheet" />



    <style>
        .progress {
            // display: flex;
            // height: auto !important;
            width: 100%;
            // font-size: .65625rem;
            background-color: #303641;
            border-radius: .25rem;
            background: red;
            z-index: 0;
            //width: 500px;
            // height: 10px !important;
        }

        div.progress {
            height: 10px;
        }

        div.steps li a {
            // color: #fff !important;
        }


        .modal-dialog {
            position: relative;
            display: table;
            overflow: auto;
            width: auto;
            min-width: 300px;
        }

        .modal-body { /* Restrict Modal width to 90% */
            overflow-x: auto !important;
            max-width: 90vw !important;
        }

        .youtube-icon {
            position: absolute;
            top: 40%;
            left: 45%;
            font-size: 30px;
        }

        .youtube-icon {
            position: absolute;
            top: 40%;
            left: 45%;
            font-size: 30px;
        }

            .youtube-icon:hover {
                font-size: 40px;
                color: red;
            }

        .titlebar_title {
            color: #333;
        }

        .bootstrap-tagsinput {
            line-height: 62px;
            width: 100%;
        }

        .image_picker_image {
            width: 120px;
            height: 120px;
        }

        ul.thumbnails.image_picker_selector {
            max-height: 300px;
            overflow-y: auto;
        }

        .modal {
            overflow: auto !important;
        }
    </style>
    <style>
        /* FancyMe Tags Plugin
        * By Pamela Rodriguez
        * Free to use
        * Link backs are appreciated :)
        * www.thepamrdz.com
        */

        /*Plugin CSS - Basic styling*/


        .fancyme-tags input[type=text] {
            padding: 5px;
            border: 1px solid #ccc;
        }

        .fancyme-tags input[type=button] {
            padding: 6px;
            border: 0;
            background-color: #bbb;
            color: #333;
            -moz-box-shadow: 2px 2px 0px 1px #999;
            -webkit-box-shadow: 2px 2px 0px 1px #999;
            box-shadow: 2px 2px 0px 1px #999;
            cursor: pointer;
        }

            .fancyme-tags input[type=button]:hover {
                background-color: #ddd;
            }

        .fancyme-tags .shownlist {
            display: block;
            clear: both;
            margin-top: 15px;
            padding-left: 3px;
        }

            .fancyme-tags .shownlist span {
                display: block;
                float: left;
                padding: 5px 8px;
                background-color: #aaa;
                color: #fff;
                margin: 10px 10px 0 0;
            }

                .fancyme-tags .shownlist span a {
                    color: #fff;
                    text-decoration: none;
                    font-weight: 900;
                }

        /*Plugin CSS - Theme Styling*/

        .fancyme-tags.blue input[type=button] {
            background-color: #374c85;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #25325a;
            -webkit-box-shadow: 3px 3px 0px 1px #25325a;
            box-shadow: 3px 3px 0px 1px #25325a;
        }

            .fancyme-tags.blue input[type=button]:hover {
                background-color: #6481d0;
                color: #fff;
            }

        .fancyme-tags.blue #shownlist span {
            background-color: #374c85;
        }

        .fancyme-tags.red input[type=button] {
            background-color: #921307;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #5f0100;
            -webkit-box-shadow: 3px 3px 0px 1px #5f0100;
            box-shadow: 3px 3px 0px 1px #5f0100;
        }

            .fancyme-tags.red input[type=button]:hover {
                background-color: #dc2412;
                color: #fff;
            }

        .fancyme-tags.red .shownlist span {
            background-color: #921307;
        }

        .fancyme-tags.green input[type=button] {
            background-color: #1c7f2c;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #084c24;
            -webkit-box-shadow: 3px 3px 0px 1px #084c24;
            box-shadow: 3px 3px 0px 1px #084c24;
        }

            .fancyme-tags.green input[type=button]:hover {
                background-color: #35bb4a;
                color: #fff;
            }

        .fancyme-tags.green .shownlist span {
            background-color: #1c7f2c;
        }

        .fancyme-tags.yellow input[type=button] {
            background-color: #ffde00;
            color: #333;
            -moz-box-shadow: 3px 3px 0px 1px #ffbf00;
            -webkit-box-shadow: 3px 3px 0px 1px #ffbf00;
            box-shadow: 3px 3px 0px 1px #ffbf00;
        }

            .fancyme-tags.yellow input[type=button]:hover {
                background-color: #fbe972;
                color: #333;
            }

        .fancyme-tags.yellow .shownlist span {
            background-color: #ffde00;
            color: #333;
        }

            .fancyme-tags.yellow .shownlist span a {
                color: #333;
            }

        .fancyme-tags.orange input[type=button] {
            background-color: #ee8a00;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #d85200;
            -webkit-box-shadow: 3px 3px 0px 1px #d85200;
            box-shadow: 3px 3px 0px 1px #d85200;
        }

            .fancyme-tags.orange input[type=button]:hover {
                background-color: #ffbe64;
                color: #fff;
            }

        .fancyme-tags.orange .shownlist span {
            background-color: #ee8a00;
        }

        .fancyme-tags.pink input[type=button] {
            background-color: #9d4978;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #891d59;
            -webkit-box-shadow: 3px 3px 0px 1px #891d59;
            box-shadow: 3px 3px 0px 1px #891d59;
        }

            .fancyme-tags.pink input[type=button]:hover {
                background-color: #d372a8;
                color: #fff;
            }

        .fancyme-tags.pink .shownlist span {
            background-color: #9d4978;
        }

        .fancyme-tags.purple input[type=button] {
            background-color: #7a52b1;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #351662;
            -webkit-box-shadow: 3px 3px 0px 1px #351662;
            box-shadow: 3px 3px 0px 1px #351662;
        }

            .fancyme-tags.purple input[type=button]:hover {
                background-color: #a474e6;
                color: #fff;
            }

        .fancyme-tags.purple .shownlist span {
            background-color: #7a52b1;
        }

        .fancyme-tags.black input[type=button] {
            background-color: #555;
            color: #fff;
            -moz-box-shadow: 3px 3px 0px 1px #000;
            -webkit-box-shadow: 3px 3px 0px 1px #000;
            box-shadow: 3px 3px 0px 1px #000;
        }

            .fancyme-tags.black input[type=button]:hover {
                background-color: #888;
                color: #fff;
            }

        .fancyme-tags.black .shownlist span {
            background-color: #555;
        }
    </style>



}



<div class="row page-titles">
    <div class="col-md-5 align-self-center">
        <h4 class="text-themecolor">Operation </h4>
    </div>
    <div class="col-md-7 align-self-center text-right">
        <div class="d-flex justify-content-end align-items-center">
            <ol class="breadcrumb">

                <li class="breadcrumb-item"><a href="javascript:void(0)">&nbsp; &nbsp;Home</a></li>
                <li class="breadcrumb-item">Business </li>
                <li class="breadcrumb-item active">Operation </li>
            </ol>

            @if (Model == (int)EntityState.Old)
            {
                @*<button type="button" class="btn btn-info d-none d-lg-block m-l-15 JsDownloadIdea"> <i class="fas fa-file-pdf"></i> Download</button>*@
                <button type="button" class="btn btn-primary d-none d-lg-block m-l-15 JsUpdate"> Update</button>

            }


        </div>
    </div>
</div>
<div id="myDialog3">
    <iframe id="cartoonVideo" width="100%" height="100%" src="@(ViewBag.Video != null ?  ViewBag.Video.VideoUrl : "")" auto frameborder="0" allowfullscreen></iframe>
</div>
@{
    if (Model == (int)EntityState.New) { Html.RenderAction("New", "Business", new { Type = (int)Business_Model.Model.BusinessSection.BusinessOperation }); }
    else { Html.RenderAction("Detail", "Business", new { Type = (int)Business_Model.Model.BusinessSection.BusinessOperation }); }
}







@section PageScript
{
    <!-- This Page JS -->
    <script src="~/assets/node_modules/wizard/jquery.steps.min.js"></script>
    <script src="~/assets/node_modules/wizard/jquery.validate.min.js"></script>
    <script src="~/assets/node_modules/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <script src="~/assets/node_modules/sparkline/jquery.sparkline.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="~/assets/node_modules/Magnific-Popup-master/dist/jquery.magnific-popup.min.js"></script>
    <script src="~/assets/node_modules/Magnific-Popup-master/dist/jquery.magnific-popup-init.js"></script>
    <script src="~/assets/node_modules/draggable-resizable-modal/js/modalbox.js"></script>
    <script src="~/assets/node_modules/switchery/dist/switchery.min.js"></script>
    <script src="~/assets/node_modules/bootstrap-select/bootstrap-select.min.js" type="text/javascript"></script>
    <script src="~/assets/node_modules/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js"></script>
    <script src="~/assets/node_modules/image-picker/image-picker.js"></script>
    <script src="~/assets/node_modules/dff/dff.js" type="text/javascript"></script>
    <script src="~/assets/node_modules/select2/dist/js/select2.full.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="~/assets/node_modules/multiselect/js/jquery.multi-select.js"></script>
    <script src="~/assetsss/js/jq.progress-bar.js"></script>
    <script src="@Url.ContentVersioned("~/page_script/business-operation.js")"></script>



    <script>
        $(function () {
        $('.selectpicker').selectpicker();
        });
        var showMessage = "Temporayfor someytime";
        $("#myDialog3").myOwnDialog(
            {
                autoClose: false,
                width: "400",
                pos_y: "50",
                height: "300",
                bg_color: 'white',
                title: '@(ViewBag.Video != null ?  ViewBag.Video.Title : "")',
                body_margin:  '@(ViewBag.Video != null ?  ViewBag.Video.Duration : "")',
                body_overflow_x: "hidden",
                body_overflow_y: "scroll",
                movable: true,
                resizable: true,
                touchOutsideForClose: false
            });

    </script>
    @{
        if (Model == (int)EntityState.New)
        {
            <script>setTimeout(function () { $("#myDialog3").myOwnDialog("open"); }, 1000);</script>
 }
    }
    <script>
        /* FancyMe Tags Plugin
* By Pamela Rodriguez
* Free to use
* Link backs are appreciated :)
* www.thepamrdz.com
*/

        (function ($) {

            $.fn.fancymetags = function (params) {
                params = $.extend({
                    theme: 'default', // Available themes: blue, red, orange, green, pink, black, yellow, and purple
                }, params);
                var main = $(this);
                main.addClass(params.theme);
                main.addClass("fancyme-tags");
                main.html("<input type='text' class='form-control' /><div class='input-group-append'> <button class='btn btn-success JsAddTag' type='button'><i class='fa fa-plus'></i></button></div></div>");

                function getTags() {//Gets array of existing tags
                    var alltags = new Array();
                    var i = 0;
                    $(".fancyme-tags #shownlist span").each(function (index) {
                        alltags[i] = $(this).html().substr(0, $(this).html().length - 20);
                        i++;
                    });
                    return alltags;
                };

                function setTags() {//Gets string of existing tags separated by commas
                    var texttags = getTags();
                    var finaltext = "";
                    for (var i = 0; i < texttags.length; i++) {
                        if (finaltext == "") {
                            finaltext = texttags[i];
                        }
                        else {
                            finaltext = finaltext + "," + texttags[i];
                        }
                    }
                    return finaltext;
                }

                function addTags() {

                    // var element = $(this).closest("div.JSfancyme-tags");
                    var element = $(this).closest("div.jsOperationInvolvedParty");
                    var partyType = element.find("select.jsThirdPartyType").val();
                    var counter = element.find(".jsCounter").val();
                    //  var type = element.siblings("div.jsThirdPartyInvolvedID").find("select.jsThirdPartyType").val();

                    var tags = element.find(".fancyme-tags input[type=text]").val().trim();
                    var listnews = "";
                    var newtags = "";
                    var existenttags = getTags();
                    //checks if a comma was left alone at the end and removes it
                    if (tags.substr(tags.length - 1) == ",") {
                        tags = tags.substr(0, tags.length - 1);
                    }
                    //checks if a comma was left alone at the beginning and removes it
                    if (tags.substr(0, 1) == ",") {
                        tags = tags.substr(1, tags.length);
                    }
                    //if more than one tag was added
                    if (tags.indexOf(",") !== -1) {
                        var artags = tags.split(',');
                        for (var i = 0; i < artags.length; i++) {
                            if ((artags[i].trim() !== "") && ($.inArray(artags[i].trim(), existenttags) == -1)) {
                                listnews = listnews + '<span>' + artags[i].trim() + ' | <a href="#">x</a></span>';
                                existenttags.push(artags[i].trim());
                            }
                        }
                    }
                    //else if just one tag was added
                    else {
                        if ($.inArray(tags, existenttags) == -1) {
                            var RandomNumber = Math.floor((Math.random() * 100000056888007000) + 100);
                            listnews = '<span> <input type="hidden" class="jsRandomNumber" value=' + RandomNumber + '>' + tags + ' | <a href="#">x</a></span>';
                            thirdPartylist.push({ "Value1": partyType, "Value2": tags, "Value3": RandomNumber, "Value4": counter });
                        }
                    }
                    //adds everything to the html and clears the value of the textfield
                    element.find(".jslistThirdPartyInvolvedID").val(partyType);
                    element.find(".fancyme-tags .shownlist").append(listnews);
                    element.find(".fancyme-tags input[type=text]").val("");
                    element.find(".fancyme-tags #hiddenlist").html(setTags());

                };
                //event listeners for button and for the enter keypress
                $(".fancyme-tags .JsAddTag").click(addTags);
                $(".fancyme-tags input[type=text]").keypress(function (e) {
                    if (e.which == 13) {
                        addTags();
                    }
                });
                //erase event binding for the Xs in each tag
                $(document).on('click', '.fancyme-tags .shownlist span a', function () {
                    event.preventDefault();
                    var btn = $(this);
                    var hiddens = $(".fancyme-tags #hiddenlist").text();
                    var tag = btn.parent().html().toString();
                    var _randomNumber = btn.siblings(".jsRandomNumber").val();
                    tag = tag.substr(0, tag.length - 20);
                    btn.parent().remove();
                    $(".fancyme-tags #hiddenlist").html(setTags());
                    thirdPartylist = $.grep(thirdPartylist, function (e) {
                        return e.Value3 != _randomNumber;
                    });

                    console.log(thirdPartylist);
                });
            };

        })(jQuery);
    </script>
    <script>
        $(function () {
            $(".tagfield").fancymetags({ theme: "black" });
            //  $(".tagfield2").fancymetags({theme: "black"});
        });
    </script>
}



